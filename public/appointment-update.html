<!DOCTYPE html>
<html>
<head>
    <title>Update Appointment</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="/src/findAppointment.js"></script> <!-- Include the findAppointment.js script -->
</head>
<body>
    <div class="header-holder">
        <h1><a href="index.html" class="site-name">Appointment Management</a></h1>
    </div>
    
    <div class="buttons-holder">
        <a href="appointment-new.html" class="button">New Appointment</a><br>
        <a href="appointment-update.html" class="button">Update Appointment</a><br>
        <a href="appointment-delete.html" class="button">Delete Appointment</a><br>
        <a href="clinic-appointments.html" class="button">Clinic Stats</a>
    </div>

    <div class="form-holder">
        <h2>Update Appointment</h2>
        <br>

        <!-- Appointment ID Search to Update -->
        <form id="updateAppointmentForm" onsubmit="return false;">
            <label for="appointmentID">Appointment ID:</label>
            <input type="text" id="appointmentID" placeholder="Appointment ID" required><br>
            <input type="submit" value="Find" onclick="findAndUpdateAppointment()">
        </form> <br>

        <!-- Appointment Details Preview -->
        <form id="updateForm" style="display:none;"> <!-- Hide form until appointment is found -->
            <!-- Display appointment details here -->
            <label for="apptStatus">Status:</label>
            <input type="text" id="apptStatus" readonly><br>
            <label for="apptDate">Appointment Date:</label>
            <input type="date" id="apptDate" readonly><br>
            <label for="apptTime">Appointment Time:</label>
            <input type="time" id="apptTime" readonly><br>
            <label for="apptType">Appointment Type:</label>
            <input type="text" id="apptType" readonly><br>
            <label for="virtual">Virtual?:</label>
            <input type="text" id="virtual" readonly><br>
        </form>
    </div>

    <script>
        // Function to find and update appointment
        function findAndUpdateAppointment() {
            var appointmentId = document.getElementById('appointmentID').value;
            
            // Call the findAppointment function from findAppointment.js
            findAppointmentById(appointmentId, function(err, appointment) {
                if (err) {
                    console.error('Error finding appointment:', err);
                    alert('Appointment not found.');
                } else {
                    // Display appointment details in the form
                    document.getElementById('apptStatus').value = appointment.status;
                    document.getElementById('apptDate').value = appointment.date;
                    document.getElementById('apptTime').value = appointment.time;
                    document.getElementById('apptType').value = appointment.type;
                    document.getElementById('virtual').value = appointment.virtual;
                    
                    // Show the update form
                    document.getElementById('updateForm').style.display = 'block';
                }
            });
        }
    </script>
</body>
</html>
